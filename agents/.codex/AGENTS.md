# 全局 Codex CLI 工作约定

## 语言与输出

- 始终使用简体中文回复。
- 编写代码注释时，必须使用简体中文。
- 生成/修改 `AGENTS.md` 时，必须使用简体中文撰写。

## 联网搜索

- 默认允许且优先使用联网搜索获取最新信息（尤其是涉及“最新/最近/今天/最佳实践/接口细节/版本变更/安全建议”等）。
- 所有网络操作**优先**使用 tavily MCP，其次是 Codex CLI 自带的联网搜索工具。

## AGENTS.md（生成/更新最佳实践）

- 在生成或更新任何 `AGENTS.md` / `AGENTS.override.md` 前，必须先联网查阅 Codex 官方指南，并以其**最新推荐写法**为准：<https://developers.openai.com/codex/guides/agents-md>。
- 优先写“可执行的工作约定”：安装/启动/测试/格式化命令、代码风格、依赖与安全边界；避免长篇背景介绍。
- 规则过多时用分层：通用约定放上层 `AGENTS.md`，子项目/目录特化规则放就近目录的 `AGENTS.override.md`（存在 override 时避免重复与冲突）。

## Python 项目约定

- 默认使用 `uv` 管理 Python 环境与依赖。
- 安装/新增依赖优先使用 `uv add <package>`。
- 运行 Python 脚本优先使用 `uv run python <script.py>`（需要传参时同理追加参数）。
- 配置优先使用 `Hydra` + `YAML`，避免用 `argparse` 堆参数。
- 深度学习项目优先使用 `PyTorch Lightning`。

## 代码库上下文全量检索（augment-context-engine MCP）

- **执行条件**：在生成任何建议或代码前。
- **工具调用**：调用 augment-context-engine MCP。
- **检索策略**：
  - 禁止基于假设回答。
  - 使用自然语言构建语义查询。
  - **完整性检查**：必须获取相关类、函数、变量的完整定义与签名。若上下文不足，触发递归检索。
- **需求对齐**：若检索后需求仍有模糊空间，**必须**向用户输出引导性问题列表，直至需求边界清晰（无遗漏、无冗余）。

## 代码与文档风格

- 整体代码风格**始终定位**为，精简高效、毫无冗余。该要求同样适用于注释与文档。
- 对于文档，严格遵循**非必要不形成**的核心原则。
- **仅对需求做针对性改动**，严禁影响用户现有的其他功能。
